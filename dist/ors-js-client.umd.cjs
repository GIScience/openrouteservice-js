!function(e,s){"object"==typeof exports&&"undefined"!=typeof module?module.exports=s():"function"==typeof define&&define.amd?define(s):(e="undefined"!=typeof globalThis?globalThis:e||self).OrsJsClient=s()}(this,(function(){"use strict";const e={defaultAPIVersion:"v2",defaultHost:"https://api.openrouteservice.org",missingAPIKeyMsg:"Please add your openrouteservice api_key..",useAPIV2Msg:"Please use ORS API v2",baseUrlConstituents:["host","service","api_version","mime_type"],propNames:{apiKey:"api_key",host:"host",service:"service",apiVersion:"api_version",mimeType:"mime_type",profile:"profile",format:"format",timeout:"timeout"}};class s{fillArgs(e,s){return s={...e,...s}}saveArgsToCache(s){return{host:s[e.propNames.host],api_version:s[e.propNames.apiVersion],profile:s[e.propNames.profile],format:s[e.propNames.format],service:s[e.propNames.service],api_key:s[e.propNames.apiKey],mime_type:s[e.propNames.mimeType]}}prepareRequest(s){return delete s[e.propNames.mimeType],delete s[e.propNames.host],delete s[e.propNames.apiVersion],delete s[e.propNames.service],delete s[e.propNames.apiKey],delete s[e.propNames.profile],delete s[e.propNames.format],delete s[e.propNames.timeout],{...s}}prepareUrl(s){let t=s[e.propNames.host],r=[s[e.propNames.apiVersion],s[e.propNames.service],s[e.propNames.profile],s[e.propNames.format]];return r=r.join("/"),r=r.replace(/\/(\/)+/g,"/"),"/"===r[0]&&(r=r.slice(1)),"/"===r.slice(-1)[0]&&(r=r.slice(0,-1)),t=t+"/"+r,t}}const t=new s;class r{constructor(e){this.defaultArgs={},this.requestArgs={},this.argsCache=null,this.customHeaders={},this._setRequestDefaults(e)}_setRequestDefaults(s){if(this.defaultArgs[e.propNames.host]=e.defaultHost,s[e.propNames.host]&&(this.defaultArgs[e.propNames.host]=s[e.propNames.host]),s[e.propNames.service]&&(this.defaultArgs[e.propNames.service]=s[e.propNames.service]),!(e.propNames.apiKey in s))throw console.error(e.missingAPIKeyMsg),new Error(e.missingAPIKeyMsg);this.defaultArgs[e.propNames.apiKey]=s[e.propNames.apiKey]}checkHeaders(){this.requestArgs.customHeaders&&(this.customHeaders=this.requestArgs.customHeaders,delete this.requestArgs.customHeaders),"Content-type"in this.customHeaders||(this.customHeaders={...this.customHeaders,"Content-type":"application/json"})}async createRequest(s){let r=t.prepareUrl(this.argsCache);"pois"===this.argsCache[e.propNames.service]&&(r+=r.indexOf("?")>-1?"&":"?");const i={Authorization:this.argsCache[e.propNames.apiKey]},o=new AbortController,a=setTimeout((()=>o.abort("timed out")),this.defaultArgs[e.propNames.timeout]||5e3);try{const e=await fetch(r,{method:"POST",body:JSON.stringify(s),headers:{...i,...this.customHeaders},signal:o.signal});if(!e.ok)throw{status:e.status,message:e.statusText};return await e.json()||e.text}catch(n){const e=new Error(n.message);throw e.status=n.status,console.error(e),e}finally{clearTimeout(a)}}getBody(){return this.httpArgs}async calculate(s){if(this.requestArgs=s,this.checkHeaders(),this.requestArgs=t.fillArgs(this.defaultArgs,this.requestArgs),this.requestArgs[e.propNames.apiVersion]===e.defaultAPIVersion){this.argsCache=t.saveArgsToCache(this.requestArgs),this.httpArgs=t.prepareRequest(this.requestArgs);const e=this.getBody(this.httpArgs);return await this.createRequest(e)}console.error(e.useAPIV2Msg)}}const i=new s;const o=new s;const a=new s;const n=new s;const u={Util:s,Input:class{constructor(e,s){this.setCoord(e,s)}round(e,s){return void 0===s&&(s=1e6),Math.round(e*s)/s}setCoord(e,s){this.coord=[this.round(e),this.round(s)]}},Geocode:class extends r{constructor(e){super(e),this.lookupParameter={api_key:function(e,s){return e+"="+s},text:function(e,s){return"&"+e+"="+encodeURIComponent(s)},focus_point:function(e,s){let t="";return t+="&focus.point.lon="+s[1],t+="&focus.point.lat="+s[0],t},boundary_bbox:function(e,s){let t="";return t+="&boundary.rect.min_lon="+s[0][1],t+="&boundary.rect.min_lat="+s[0][0],t+="&boundary.rect.max_lon="+s[1][1],t+="&boundary.rect.max_lat="+s[1][0],t},point:function(e,s){if(s&&Array.isArray(s.lat_lng)){let e="";return e+="&point.lon="+s.lat_lng[1],e+="&point.lat="+s.lat_lng[0],e}},boundary_circle:function(e,s){let t="";return t+="&boundary.circle.lon="+s.lat_lng[1],t+="&boundary.circle.lat="+s.lat_lng[0],t+="&boundary.circle.radius="+s.radius,t},sources:function(e,s){let t="&sources=";if(s){for(const e in s)Number(e)>0&&(t+=","),t+=s[e];return t}},layers:function(e,s){let t="&layers=",r=0;for(e in s)r>0&&(t+=","),t+=s[e],r++;return t},boundary_country:function(e,s){return"&boundary.country="+s},size:function(e,s){return"&"+e+"="+s},address:function(e,s){return"&"+e+"="+s},neighbourhood:function(e,s){return"&"+e+"="+s},borough:function(e,s){return"&"+e+"="+s},locality:function(e,s){return"&"+e+"="+s},county:function(e,s){return"&"+e+"="+s},region:function(e,s){return"&"+e+"="+s},postalcode:function(e,s){return"&"+e+"="+s},country:function(e,s){return"&"+e+"="+s}}}getParametersAsQueryString(s){let t="";for(const r in s){const i=s[r];e.baseUrlConstituents.indexOf(r)<=-1&&(t+=this.lookupParameter[r](r,i))}return t}async geocodePromise(){let s=i.prepareUrl(this.requestArgs);s+="?"+this.getParametersAsQueryString(this.requestArgs);const t=new AbortController,r=setTimeout((()=>t.abort("timed out")),this.defaultArgs[e.propNames.timeout]||5e3);try{const e=await fetch(s,{method:"GET",headers:this.customHeaders,signal:t.signal});if(!e.ok)throw{status:e.status,message:e.statusText};return await e.json()||e.text}catch(o){const e=new Error(o.message);throw e.status=o.status,console.error(e),e}finally{clearTimeout(r)}}async geocode(s){return this.requestArgs=s,this.checkHeaders(),this.defaultArgs[e.propNames.service]||this.requestArgs[e.propNames.service]||(this.requestArgs.service="geocode/search"),this.requestArgs=i.fillArgs(this.defaultArgs,this.requestArgs),await this.geocodePromise()}async reverseGeocode(s){return this.requestArgs=s,this.checkHeaders(),this.defaultArgs[e.propNames.service]||this.requestArgs[e.propNames.service]||(this.requestArgs.service="geocode/reverse"),this.requestArgs=i.fillArgs(this.defaultArgs,this.requestArgs),await this.geocodePromise()}async structuredGeocode(s){return this.requestArgs=s,this.checkHeaders(),this.defaultArgs[e.propNames.service]||this.requestArgs[e.propNames.service]||(this.requestArgs.service="geocode/search/structured"),this.requestArgs=i.fillArgs(this.defaultArgs,this.requestArgs),await this.geocodePromise()}},Isochrones:class extends r{constructor(s){super(s),this.defaultArgs[e.propNames.service]||this.requestArgs[e.propNames.service]||(this.defaultArgs.service="isochrones"),s[e.propNames.apiVersion]||(this.defaultArgs.api_version=e.defaultAPIVersion)}getBody(e){const s={};return e.restrictions&&(s.profile_params={restrictions:{...e.restrictions}},delete e.restrictions),e.avoidables&&(s.avoid_features=[...e.avoidables],delete e.avoidables),e.avoid_polygons&&(s.avoid_polygons={...e.avoid_polygons},delete e.avoid_polygons),Object.keys(s).length>0?{...e,options:s}:{...e}}},Directions:class extends r{constructor(s){super(s),this.defaultArgs[e.propNames.service]||(this.defaultArgs[e.propNames.service]="directions"),s[e.propNames.apiVersion]||(this.defaultArgs.api_version=e.defaultAPIVersion)}getBody(e){return e.options&&"object"!=typeof e.options&&(e.options=JSON.parse(e.options)),e.restrictions&&(e.options=e.options||{},e.options.profile_params={restrictions:{...e.restrictions}},delete e.restrictions),e.avoidables&&(e.options=e.options||{},e.options.avoid_features=[...e.avoidables],delete e.avoidables),e}},Matrix:class extends r{constructor(s){super(s),this.defaultArgs[e.propNames.service]||this.requestArgs[e.propNames.service]||(this.defaultArgs[e.propNames.service]="matrix"),s[e.propNames.apiVersion]||(this.defaultArgs.api_version=e.defaultAPIVersion)}},Pois:class extends r{constructor(s){super(s),this.defaultArgs[e.propNames.service]||(this.defaultArgs[e.propNames.service]="pois")}generatePayload(s){const t={};for(const r in s)e.baseUrlConstituents.indexOf(r)>-1||r===e.propNames.apiKey||r===e.propNames.timeout||(t[r]=s[r]);return t}async poisPromise(){this.requestArgs.request=this.requestArgs.request||"pois",this.argsCache=o.saveArgsToCache(this.requestArgs),this.requestArgs[e.propNames.service]&&delete this.requestArgs[e.propNames.service];const s=this.generatePayload(this.requestArgs);return await this.createRequest(s)}async pois(e){return this.requestArgs=e,this.checkHeaders(),this.requestArgs=o.fillArgs(this.defaultArgs,this.requestArgs),await this.poisPromise()}},Elevation:class extends r{generatePayload(s){const t={};for(const r in s)e.baseUrlConstituents.indexOf(r)<=-1&&(t[r]=s[r]);return t}async elevationPromise(){this.argsCache=a.saveArgsToCache(this.requestArgs);const e=this.generatePayload(this.requestArgs);return await this.createRequest(e)}async lineElevation(s){return this.requestArgs=s,this.checkHeaders(),this.defaultArgs[e.propNames.service]||this.requestArgs[e.propNames.service]||(this.requestArgs[e.propNames.service]="elevation/line"),this.requestArgs=a.fillArgs(this.defaultArgs,this.requestArgs),await this.elevationPromise()}async pointElevation(s){return this.requestArgs=s,this.checkHeaders(),this.defaultArgs[e.propNames.service]||this.requestArgs[e.propNames.service]||(this.requestArgs[e.propNames.service]="elevation/point"),this.requestArgs=a.fillArgs(this.defaultArgs,this.requestArgs),await this.elevationPromise()}},Optimization:class extends r{generatePayload(s){let t={};for(const r in s)e.baseUrlConstituents.indexOf(r)<=-1&&(t[r]=s[r]);return t}async optimizationPromise(){this.argsCache=n.saveArgsToCache(this.requestArgs);const e=this.generatePayload(this.requestArgs);return await this.createRequest(e)}async optimize(s){return this.requestArgs=s,this.checkHeaders(),this.defaultArgs[e.propNames.service]||s[e.propNames.service]||(s[e.propNames.service]="optimization"),this.requestArgs=n.fillArgs(this.defaultArgs,this.requestArgs),await this.optimizationPromise()}}};return"object"==typeof module&&"object"==typeof module.exports?module.exports=u:"function"==typeof define&&define.amd&&define(u),"undefined"!=typeof window&&(window.Openrouteservice=u),u}));
//# sourceMappingURL=ors-js-client.umd.cjs.map
